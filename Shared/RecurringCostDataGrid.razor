@using HCatalystProjectCostsSite.Models
@using System.Collections.ObjectModel
@using HCatalystProjectCostsSite.Enums

<MudDataGrid Items="@costs" Filterable="false" SortMode="@SortMode.None" Groupable="false">
    <Columns>
        <PropertyColumn Property="x => x.submission.title" Title="Cost" />
        <PropertyColumn Property="x => x.cost" Format="C"  Title="Amount"/>
        <PropertyColumn Property="x => x.basis"  Title="Basis"/>
        <PropertyColumn Property="x => x.AnnualCost()" Title="Annual Cost"  
                        Format="C" AggregateDefinition="_costAggregation"/>
        <PropertyColumn Property="x => x.submission.author"  Title="Submitted By"/>
        <PropertyColumn Property="x => x.submission.submittedOn"  Title="Submitted On"/>
    </Columns>
</MudDataGrid>

@code {
    
    [Parameter]
    public ObservableCollection<Cost> costs { get; set; } = new();

    private AggregateDefinition<Cost> _costAggregation = new AggregateDefinition<Cost>
    {
        Type = AggregateType.Custom,
        CustomAggregate = x =>
        {
            var total = x.Sum(y => y.AnnualCost());
            return $"Total Annual Cost is {total:C0}";
        }
    };

}